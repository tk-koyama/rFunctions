grid_col <- if ("col" %in% names(extra_args)) extra_args$col else "gray90"
points_col <- if ("col" %in% names(extra_args)) extra_args$col else NULL
boxplot_col <- if ("col" %in% names(extra_args)) extra_args$col else NULL
# Remove 'col' from extra_args to prevent duplication
extra_args$col <- NULL
# Filter valid arguments for each function
grid_args <- extra_args[names(extra_args) %in% valid_grid_args]
points_args <- extra_args[names(extra_args) %in% valid_points_args]
boxplot_args <- extra_args[names(extra_args) %in% valid_boxplot_args]
# Handle formula input
if (!is.null(data) && inherits(y, "formula")) {
mf <- model.frame(y, data, na.action = na.pass)  # Keep NA values
g <- mf[[2]]  # Extract grouping variable
y <- mf[[1]]  # Extract numeric vector
}
if(length(y) != length(g) && !is.null(g)) stop('y and g must have the same length.\n')
# If no grouping variable is provided, create a single group
if (is.null(g)) {
g <- factor(rep(1, length(y)))
}
g <- as.factor(g)  # Ensure g is a factor
# If no group_names is provided, use levels of g.
if(is.null(group_names)) group_names <- levels(g)
if(length(group_names) != nlevels(g)) stop('Length of group_names must match the number of groups.\n')
# If no group_positions is provided, use 1, 2, 3, ...
if(is.null(group_positions)) group_positions <- seq_len(nlevels(g))
if(length(unique(group_positions)) != nlevels(g)) stop('Length of unique group_positions must match the number of groups.\n')
# Replicate fig_type to cover all groups (except NA group)
fig_type <- rep(fig_type, length.out=nlevels(g))
# Ensure box_col is recycled properly and include NA_box_col before modifying levels(g)
box_col <- c(rep(box_col, length.out = nlevels(g)), NA_box_col)
# Handle NA in g only if there is missingness in g and NA_as_group is TRUE.
if( all(!is.na(g)) ) NA_as_group <- FALSE
if( NA_as_group & all(is.na(y[is.na(g)])) ){
warning('y is all missing when g is missing. Nothing to plot in Missing group.\n')
NA_as_group <- FALSE
}
# Suggest a good clustering_distance
if(is.null(clustering_distance)) clustering_distance <- IQR(y, na.rm=TRUE) / 10
# Handle missing values in g
if(NA_as_group){
levels(g) <- c(levels(g), NA_group_name)
g[is.na(g)] <- NA_group_name
group_names <- levels(g)
NA_group_position <- ifelse(is.null(NA_group_position) || NA_group_position %in% group_positions, max(group_positions) + 1, NA_group_position)
group_positions <- c(group_positions, NA_group_position)
}
# Remove 'bd' in type is replaced by 'b'
fig_type <- c(fig_type, NA_fig_type)
if ('bd' %in% fig_type) warning('type "bd" (boxplot in front of dots) is being replaced by "b" boxplot only.\n')
fig_type[fig_type=='bd'] <- 'b'
# Ensure grid() gets only relevant arguments
do.call(grid, c(list(nx = NA, ny = NULL, col = grid_col, lty = "dotted"), grid_args))
do.call(plot, c(list(0, type='n', ylim=range(y, na.rm=TRUE), xlim=range(group_positions)+c(-0.5, 0.5), xaxt='n'), extra_args))
axis(1, at=group_positions, labels=group_names, tick=FALSE, line=1)
if (show_n) {
group_sizes <- table(g[!is.na(y)])
group_sizes_labels <- sprintf("N=%d", group_sizes)
mtext(group_sizes_labels, side=3, at=group_positions, line=0.5)
}
for(i in seq_along(group_positions)) {
this <- grouped_data[[i]]
if(fig_type[i] %in% c('b','db')){
do.call(boxplot, c(list(this$y, add=TRUE, at=group_positions[i], outline=FALSE, col=boxplot_col), boxplot_args))
}
if(fig_type[i] %in% c('d','db')){
do.call(points, c(list(group_positions[i] + this$jitter_pos * jitter_amount, this$y, col=points_col, pch=this$pch), points_args))
}}
if (output) return(grouped_data)
}
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col='dodgerblue', group_pch=19,
box_col='lightblue', cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3, ylab='x', col='red')
warnings()
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col='dodgerblue', group_pch=19,
box_col='lightblue', cex=0.9,  NA_group_pch=3, ylab='x', col='red')
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col='dodgerblue', group_pch=19,
box_col='lightblue', cex=0.9,  NA_group_pch=3, ylab='x', grid_col='red')
dbplot(y, g, col = "red")
y
g
dbplot(y, g, grid_col = "blue", col = "red")  # Grid is blue, everything else is red
source('dbplot')
source('dbplot.r')
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col='dodgerblue', group_pch=19,
box_col='lightblue', cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col='blue', group_pch=19,
box_col='lightblue', cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col='lightblue', cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b',d','db'), NA_as_group=TRUE, jitter_amount=0.02,
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col='lightblue', cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,3), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey90), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
gray90
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey(90), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey(90)), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey(.90)), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey(.60)), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3)
clustering_distance=NULL
jitter_amount=0.02
output=FALSE
group_names=NULL
group_positions=NULL
indiv_col=c(1,4)
group_col=1
indiv_pch=NULL
group_pch=21
NA_as_group=TRUE
NA_group_name='Missing'
NA_group_position=6
NA_group_col=NULL
NA_group_pch=NULL
show_n=TRUE
ylim=NULL
xlim=NULL
fig_type=c('d','b','db')
NA_fig_type='d'
boxplot_pars=list()
data <- NULL
NNN <- 300
set.seed(30)
y <- round(rnorm(NNN, 100, 100))
y[ sample(1:NNN, 20, TRUE)] <- NA
g <- sample(c('yui','moa','sue'), NNN, rep=TRUE)
g[ sample(1:NNN, 20, TRUE)] <- NA
indiv_col <- sample(2:5, NNN, TRUE)
group_col
y[1:5] <- c(472, 430, 450, 440, 430)
dbplot(y, g, data=NULL, fig_type=c('b','d','db'), NA_as_group=TRUE, jitter_amount=0.02,
NA_group_position=6, show_n=TRUE, indiv_col=NULL, group_col=c('blue','dodgerblue','royalblue'), group_pch=19,
box_col=c(1,2,grey(.60)), cex=0.9, notch=TRUE, boxwex=1, NA_group_pch=3, ylim=c(0, 200))
dbplot(y, g)
source('dbplot.r')
dbplot(y, g)
dbplot(y, g, NA_as_group = T)
dbplot(y, g, NA_as_group = T, show_n=TRUE)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=21)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='b')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='b', NA_fig_type='b')
source('dbplot.r')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='b', NA_fig_type='b')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='bd', NA_fig_type='b')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='db', NA_fig_type='b')
source('dbplot.r')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, group_pch=19, jitter_amount = 0.05, fig_type='db', NA_fig_type='b')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, jitter_amount = 0.05, fig_type='db', NA_fig_type='b')
source('dbplot.r')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, jitter_amount = 0.05, fig_type='db', NA_fig_type='b')
source('dbplot.r')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, jitter_amount = 0.05, fig_type='db', NA_fig_type='b')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=3, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL, NA_group_name=NULL)
source('dbplot.r')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL, NA_group_name=NULL)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL, NA_group_name='kk')
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL, NA_group_name='kk', box_col=3)
dbplot(y, g, NA_as_group = T, show_n=TRUE, ylab='x', group_col=NULL, jitter_amount = 0.05, fig_type='db', NA_fig_type='b', group_pch=NULL, NA_group_name='kk', box_col=3, NA_box_col=3)
